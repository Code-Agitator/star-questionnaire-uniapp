"use strict";var e=(e,n,o)=>new Promise(((t,u)=>{var s=e=>{try{i(o.next(e))}catch(n){u(n)}},r=e=>{try{i(o.throw(e))}catch(n){u(n)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(s,r);i((o=o.apply(e,n)).next())}));const n=require("../../common/vendor.js"),o=require("../../service/index.js");require("../../store/index.js");const t=require("../../store/modules/auth/index.js");require("../../service/helper.js"),require("../../constants/index.js"),require("../../store/modules/count/index.js"),require("../../store/modules/app/index.js"),require("../../composables/useToken.js");if(!Array){((()=>"../../node-modules/nutui-uniapp/components/input/input.js")+(()=>"../../node-modules/nutui-uniapp/components/cell/cell.js")+(()=>"../../node-modules/nutui-uniapp/components/cellgroup/cellgroup.js")+(()=>"../../node-modules/nutui-uniapp/components/button/button.js")+n.resolveComponent("layout-default-uni"))()}const u=n.defineComponent({__name:"login",setup(u){const s=n.useToast(),r=t.useAuthStore(),i=n.ref(""),l=n.ref("");function a(){return e(this,null,(function*(){const e=(yield o.instance.post("/api/user/login",{username:i.value,password:l.value})).data;e.success?(r.setToken(e.data.token),yield n.index.navigateBack({delta:1})):s.error(`登录失败:${e.message}`)}))}function p(){return e(this,null,(function*(){i.value="admin",l.value="root",yield a()}))}return(e,o)=>({a:n.o((e=>n.isRef(i)?i.value=e:null)),b:n.p({placeholder:"请输入用户名",modelValue:n.unref(i)}),c:n.p({title:"用户名"}),d:n.o((e=>n.isRef(l)?l.value=e:null)),e:n.p({type:"password",placeholder:"请输入密码",modelValue:n.unref(l)}),f:n.p({title:"密码"}),g:n.o(a),h:n.p({block:!0,type:"primary"}),i:n.o(p),j:n.p({block:!0,type:"primary"})})}}),s=n._export_sfc(u,[["__scopeId","data-v-6711a556"]]);wx.createPage(s);
